<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>SacsiN | Seller</title>

    <!-- Bootstrap CSS CDN -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <!-- Our Custom CSS -->
    <link rel="stylesheet" href="../assets/css/sacsin-admin-style.css">
    <!-- Scrollbar CSS -->
    <link rel="stylesheet" href="../assets/css/sacsin-scrollbar-style.css">

    <!-- Font Awesome JS -->
    <script defer src="../assets/fontawesome-free-5.15.3-web/js/all.min.js"></script>
</head>

<body>
    <div class="wrapper">
        <!-- Sidebar  -->
        <nav id="sidebar">
            <div class="sidebar-header">
                <h3 hidden>Bootstrap Sidebar</h3>
                <img src="../assets/img/logo/sacsin_logo_dark.png" alt="" width="100">
            </div>

            <ul class="list-unstyled components pt-5">
                <li>
                    <a href="#">
                        <span class="mx-3"><i class="fas fa-chart-pie"></i></span> Overview
                    </a>
                </li>
                <li class="active">
                    <a href="#" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">
                        <span class="mx-3"><i class="fas fa-comments"></i></span> Requests
                    </a>
                </li>
                <li>
                    <a href="#">
                        <span class="mx-3"><i class="fas fa-cogs"></i></span> Settings
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Page Content  -->
        <div id="content">

            <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light">
                <div class="container-fluid">

                    <button type="button" id="sidebarCollapse" class="btn btn-info">
                        <i class="fas fa-align-left"></i>
                    </button>

                    <div class="form-group has-search">
                        <span class="fa fa-search form-control-feedback"></span>
                        <input type="text" class="form-control" placeholder="Search">
                    </div>

                    <div class="profile">
                        <span class="mr-4 notification"><i class="fa fa-bell"></i></span>
                        <span class="mr-1 username">John Doe</span>
                        <img src="../assets/img/pp_default.jpg" alt="pp" style="border-radius: 50%;" width="35px">
                    </div>

                </div>
            </nav>

            <div class="p-5 pt-4">

                <h2 class="mb-5">
                    Request Package No: SS-12345678
                    <span class="float-right">
                        <button class="btn btn-primary px-5 py-2">
                            <i class="fas fa-share"></i>
                            Forward
                        </button>
                    </span>
                </h2>

                <div class="card shadow-sm border-0 mb-4">
                    <div class="card-body p-0 pt-4">
                        <div class="row text-center" style="padding: 0.5rem 5rem;">
                            <div class="col-sm-4"><h4>General</h4></div>
                            <div class="col-sm-4"><h4>Requestor</h4></div>
                            <div class="col-sm-4"><h4>Responder</h4></div>
                        </div>
                        <hr class="mt-0">
                        <div class="row text-center" style="padding: 0.5rem 5rem;">
                            <div class="col-sm-4">
                                <h5>Product/Object</h5>
                                <p>FX3584 M6x50</p>
                                <!-- <br> -->
                                <h5>Request date</h5>
                                <p>2021/06/30</p>
                            </div>
                            <div class="col-sm-4">
                                <h5>Company name</h5>
                                <p>
                                    <span class="badge badge-primary rounded-circle">
                                        <i class="fas fa-check"></i>
                                    </span>
                                    Grand Berge Carpentry
                                </p>
                                <!-- <br> -->
                                <h5>Requestor ID</h5>
                                <p>SS-12342985</p>
                            </div>
                            <div class="col-sm-4">
                                <h5>Company name</h5>
                                <p>Fittings Ltd</p>
                                <!-- <br> -->
                                <h5>Responder ID</h5>
                                <p>SS-12346685</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card shadow-sm border-0 mb-4">
                    <div class="card-body">
                        <h4 class="card-title">
                            Migration from material
                        </h4>
                        <div class="table-responsive mt-5">
                            <table class="table table-hover mt-3">
                                <thead>
                                    <tr>
                                        <th scope="col">
                                            <input type="checkbox" name="">
                                        </th>
                                        <th scope="col">Element</th>
                                        <th scope="col">Standard for Test</th>
                                        <th scope="col">Maximum Limit</th>
                                        <th scope="col">Unit</th>
                                        <th scope="col">Status</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr data-display="#response">
                                        <th scope="row">
                                            <input type="checkbox" name="">
                                        </th>
                                        <td class="text-primary">Cadmium</td>
                                        <td>EN 71-3:2019</td>
                                        <td>100</td>
                                        <td>Cd/Kg</td>
                                        <td>
                                            <button class="alert alert-danger p-2 px-5" role="alert" style="border-radius: 25px;">Empty</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th scope="row">
                                            <input type="checkbox" name="">
                                        </th>
                                        <td class="text-primary">Lead</td>
                                        <td>ISO 71-4:2020</td>
                                        <td>80</td>
                                        <td>Pb/Kg</td>
                                        <td>
                                            <button class="alert alert-danger p-2 px-5" role="alert" style="border-radius: 25px;">Empty</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th scope="row">
                                            <input type="checkbox" name="">
                                        </th>
                                        <td class="text-primary">Copper</td>
                                        <td>EN 65-3:2019</td>
                                        <td>50</td>
                                        <td>Cu/Kg</td>
                                        <td>
                                            <button class="alert alert-danger p-2 px-5" role="alert" style="border-radius: 25px;">Empty</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="card shadow-sm border-0 mb-4">
                    <div class="card-body">
                        <h4 class="card-title">
                            Content in material
                        </h4>
                        <div class="table-responsive mt-5">
                            <table class="table table-hover mt-3">
                                <thead>
                                    <tr>
                                        <th scope="col">
                                            <input type="checkbox" name="">
                                        </th>
                                        <th scope="col">Element</th>
                                        <th scope="col">Maximum Limit</th>
                                        <th scope="col">Unit</th>
                                        <th scope="col">Status</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <th scope="row">
                                            <input type="checkbox" name="">
                                        </th>
                                        <td class="text-primary">Magnesium</td>
                                        <td>100</td>
                                        <td>
                                            Mg/Kg
                                        </td>
                                        <td>
                                            <button class="alert alert-danger p-2 px-5" role="alert" style="border-radius: 25px;">Empty</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="card shadow-sm border-0 mb-5">
                    <div class="card-body">
                        <h4 class="card-title">
                            Substance Released from production
                        </h4>
                        <div class="table-responsive mt-5">
                            <table class="table table-hover mt-3">
                                <thead>
                                    <tr>
                                        <th scope="col">
                                            <input type="checkbox" name="">
                                        </th>
                                        <th scope="col">Substance</th>
                                        <th scope="col">Status</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <th scope="row">
                                            <input type="checkbox" name="">
                                        </th>
                                        <td class="text-primary">Carbondioxide</td>
                                        <td>
                                            <button class="alert alert-danger p-2 px-5" role="alert" style="border-radius: 25px;">Empty</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="text-right">
                    <button type="button" class="btn btn-primary px-5 py-2">
                        <i class="fas fa-share"></i> Forward Selection
                    </button>
                </div>

            </div>
            
        </div>
    </div>

    <!-- Side Pane -->
    <div class="side-pane-backdrop" id="response">
        <div class="side-pane loading">
            <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light">
                <div class="container-fluid">
                    <h5 class="mt-2">Response</h5>
                    <div>
                        <button type="button" class="btn btn-light close-side-pane">Cancel</button>
                        <button type="button" class="btn btn-primary" id="tr-save">Save</button>
                    </div>
                </div>
            </nav>
            <div class="side-pane-wrapper">
                <div class="card shadow-sm border-0 m-5">
                    <div class="card-body">
                        <h5 class="card-title">
                            Confirmed continuous production below limit
                        </h5>
                        <!-- <hr> -->
                        <form action="#" class="my-4">
                            <select class="form-control" name="" id="confirm-response">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                            </select>
                        </form>
                    </div>
                </div>
                <div class="card shadow-sm border-0 m-5" id="test-report">
                    <div class="card-body">
                        <h5 class="card-title">
                            Test Report
                        </h5>
                        <form action="#" class="my-4">
                            <div class="border rounded my-3 p-3 test-report" id="test-report-1" data-display="#select-test-report" data-input="">
                                Test Report Name 1
                                <span class="float-right">
                                    <i class="fas fa-pen text-icons"></i>
                                </span>
                            </div>
                            <div class="border rounded my-3 p-3 test-report" id="test-report-2" data-display="#select-test-report" data-input="">
                                Test Report Name 2
                                <span class="float-right">
                                    <i class="fas fa-pen text-icons"></i>
                                </span>
                            </div>
                            <div class="border rounded my-3 p-3 test-report" id="test-report-3" data-display="#select-test-report" data-input="">
                                Test Report Name 3
                                <span class="float-right">
                                    <i class="fas fa-pen text-icons"></i>
                                </span>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- <div class="side-pane-backdrop" id="migration">
        <div class="side-pane loading">
            <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light">
                <div class="container-fluid">
                    <div>
                        <h4>Create Request Sentence</h4>
                    </div>
                    <div>
                        <button type="button" class="btn btn-light">Cancel</button>
                        <button type="button" class="btn btn-primary">Save</button>
                    </div>
                </div>
            </nav>
            <div class="side-pane-wrapper">
                <div class="card shadow-sm border-0 m-5">
                    <div class="card-body">
                        <h5 class="card-title">
                            Migration from material
                        </h5>
                        <hr>
                        <form action="#" class="my-4">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-4">
                                        <label for="">Element</label>
                                        <select class="form-control" name="">
                                            <option value="">Sodium</option>
                                            <option value="">Carbon</option>
                                            <option value="">Chlorine</option>
                                            <option value="">Cobalt</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label for="" class="text-white">Limit</label>
                                        <select class="form-control" name="">
                                            <option value="">Limit 0</option>
                                            <option value="">Limit 1</option>
                                            <option value="">Limit 2</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-4">
                                        <label for="">Standard for test method</label>
                                        <select class="form-control" name="">
                                            <option value="">Test Method Standard 0</option>
                                            <option value="">Test Method Standard 1</option>
                                            <option value="">Test Method Standard 2</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label for="">Unit of measure</label>
                                        <select class="form-control" name="">
                                            <option value="">Kilograms</option>
                                            <option value="">Square meters</option>
                                            <option value="">Cubic meters</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="card shadow-sm border-0 m-5">
                    <div class="card-body">
                        <h5 class="card-title">
                            Expected Response
                            <span class="float-right" data-display="#subs">
                                <i class="fas fa-pen text-icons"></i>
                            </span>
                        </h5>
                        <div class="text-center">
                            <div class="rounded-circle mx-auto" style="background: #d5d5d5; width: 125px; height: 125px; display: flex; margin-top: 4rem;">
                                <i class="fas fa-archive fa-3x m-auto text-white"></i>
                            </div>
                            <p class="text-primary pt-5 cursor-pointer" data-display="#subs">Select Expected Response</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="side-pane-backdrop" id="content-in-migration">
        <div class="side-pane loading">
            <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light">
                <div class="container-fluid">
                    <div>
                        <h4>Create Request Sentence</h4>
                    </div>
                    <div>
                        <button type="button" class="btn btn-light">Cancel</button>
                        <button type="button" class="btn btn-primary">Save</button>
                    </div>
                </div>
            </nav>
            <div class="side-pane-wrapper">
                <div class="card shadow-sm border-0 m-5">
                    <div class="card-body">
                        <h5 class="card-title">
                            Content in material
                        </h5>
                        <hr>
                        <form action="#" class="mt-4">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="mb-4">
                                        <label for="">Element</label>
                                        <select class="form-control" name="">
                                            <option value="">Sodium</option>
                                            <option value="">Carbon</option>
                                            <option value="">Chlorine</option>
                                            <option value="">Cobalt</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-4">
                                        <label for="">Maximum limit</label>
                                        <select class="form-control" name="">
                                            <option value="">Limit 0</option>
                                            <option value="">Limit 1</option>
                                            <option value="">Limit 2</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-4">
                                        <label for="">Unit of measure</label>
                                        <select class="form-control" name="">
                                            <option value="">Kilograms</option>
                                            <option value="">Square meters</option>
                                            <option value="">Cubic meters</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div> -->

        <!-- Sub Side Pane -->
        <div class="side-select-pane-backdrop" id="select-test-report">
            <div class="side-select-pane loading">
                <nav class="navbar bg-light no-shadow">
                    <div class="container-fluid">
                        <h5 class="mt-2">
                            <span class="close-sub-side-pane mr-3">
                                <i class="fas fa-times"></i>
                            </span>
                            <span id="tr-title"><!-- Title is injected here --></span>
                        </h5>
                    </div>
                </nav>
                <div class="side-select-pane-wrapper">
                    <div class="border rounded mx-5 mb-3 p-3">
                        <form id="tr-form">
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group ml-0">
                                        <label for="tr-doc-id">Document ID</label>
                                        <input type="text" class="form-control" id="tr-doc-id">
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-3">
                                <div class="col-sm-6">
                                    <div class="form-group ml-0">
                                        <label for="tr-doc-is">Document Issuer</label>
                                        <input type="text" class="form-control" id="tr-doc-is">
                                        <small class="text-details">Accredited laboratory</small>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-group ml-0">
                                        <label for="tr-result">Result</label>
                                        <input type="text" class="form-control" id="tr-result">
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="text-right mx-5">
                        <button class="btn btn-disabled px-5 py-2" id="tr-btn">Ok</button>
                    </div>
                </div>
            </div>
        </div>


    <!-- jQuery CDN  -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <!-- Popper.JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

    <script type="text/javascript">
        $(document).ready(() => {
            $('#sidebarCollapse').on('click', function () {
                $('#sidebar').toggleClass('active')
            })

            //
            $('[data-display="#response"]').on('click', (e) => {
                $('body').addClass('modal-open')
                $('#response').css('display', 'block')
                setTimeout(() => {
                    $('.side-pane').removeClass('loading')
                }, 500)
            })

            // 
            $('#confirm-response').change(() => {
                $('#confirm-response :selected').text() === "Yes" 
                ? $('#test-report').css('display', 'block')
                : $('#test-report').css('display', 'none') 
            })

            // select test report to enter details
            $('[data-display="#select-test-report"]').click((e) => {
                const id = e.target.id // id of the selected test report
                
                // display the sub side pane
                $('#select-test-report').css('display', 'block')
                setTimeout(() => {
                    $('.side-select-pane').removeClass('loading')
                }, 500)

                // set the id of the targeted test report on the form
                $('#tr-form').attr('data-for', id)

                // inject the title of the targeted test report
                $('#tr-title').append(e.target.firstChild.textContent)
                
                // listen and enable test report button if all form fields have been provided.
                $('#tr-doc-id').on('input', () => {
                    toggleTestReportBtn()
                })
                $('#tr-doc-is').on('input', () => {
                    toggleTestReportBtn()
                })
                $('#tr-result').on('input', () => {
                    toggleTestReportBtn()
                })
                
                // submit the test report form
                $('#tr-btn').on('click', () => {
                    if ($('#tr-btn').hasClass('btn-disabled') == false) {
                        // get the actual test report object id stored above
                        var _id = $('#tr-form').attr('data-for')
                        // populate the data-input attribute of the targeted test report
                        $('#'+_id).attr('data-input', JSON.stringify(getTestReportInput().input))
                        closeSubSidePane() // close the sub side pane
                        denoteTestReport() // denote the test report in question
                    }
                })
            })

            // close the sub side pane
            $('.close-sub-side-pane').click(() => {
                closeSubSidePane() // close the sub side pane
            })

            // close the side pane
            $('.close-side-pane').click(() => {
                closeSidePane() // close the side pane
            })


            //==============================================================//

            // gets and returns input from the test report form
            function getTestReportInput() {
                // get form field values.
                let doc_id = $('#tr-doc-id').val()
                let doc_is = $('#tr-doc-is').val()
                let result = $('#tr-result').val()
                // check that all form fields are filled.
                let is_valid = (doc_id != "" && doc_is != "" && result != "")
                let input = {tr_doc_id: doc_id, tr_doc_issuer: doc_is, tr_result: result}
                // return
                return {is_valid: is_valid, input: input}
            }

            // enables or disables the test report button.
            function toggleTestReportBtn() {
                if (getTestReportInput().is_valid) {
                    $('#tr-btn').removeClass('btn-disabled')
                    $('#tr-btn').addClass('btn-primary')
                } else {
                    $('#tr-btn').removeClass('btn-primary')
                    $('#tr-btn').addClass('btn-disabled')
                }
            }

            // reset the test report form fields
            function resetTestReportForm() {
                $('#tr-doc-id').val("")
                $('#tr-doc-is').val("")
                $('#tr-result').val("")
            }

            //
            function denoteTestReport() {
                $('[data-input]:not([data-input=""])').css('background', '#eef6fd')
            }

            // closes the sub side pane
            function closeSubSidePane() {
                $('.side-select-pane-backdrop').fadeOut("slow", () => {
                    $('.side-select-pane').addClass('loading')
                    $('#tr-title').empty() // clear the sub side pane title
                    resetTestReportForm() // reset the test report form
                    toggleTestReportBtn() // disable the test report button 
                })
            }

            // closes the side pane
            function closeSidePane() {
                $('.side-pane-backdrop').fadeOut("slow", () => {
                    $('.side-pane').addClass('loading')
                    $('body').removeClass('modal-open')
                    // $('#tr-title').empty() // clear the sub side pane title
                    // resetTestReportForm() // reset the test report form
                    // toggleTestReportBtn() // disable the test report button 
                })
            }

            function getResponse() {
                let tr_input = []
                let test_reports = [...$('.test-report')]
                test_reports.forEach((test_report) => {
                    tr_input.push(test_report.getAttribute('data-input'))
                })
                // console.log(tr_input)
                return tr_input
            }

            // save response
            $('#tr-save').on('click', () => {
                let response = getResponse() // get the response input
                submitResponse(response) // submit the response
                closeSidePane() // close the side pane
            })

            function submitResponse(response) {
                console.log(response)
                $('[data-display="#response"] .alert-danger').empty()
                $('[data-display="#response"] .alert-danger').append('Completed')
                $('[data-display="#response"] .alert-danger').addClass('alert-success')
                $('[data-display="#response"] .alert-danger').removeClass('alert-danger')
            }

            //==============================================================//
            //==============================================================//

            
        });
    </script>
</body>

</html>